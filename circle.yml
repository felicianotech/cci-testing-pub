general:
  artifacts:
  #  - /var/log/upstart/docker.log
machine:
  environment:
    MY_TEMP_VAR: google
    GODIST: "go1.7.3.linux-amd64.tar.gz"
  services:
    - docker
  python:
    version: 3.3.6
dependencies:
  pre:
    - mkdir -p download
    - test -e download/$GODIST || curl -o download/$GODIST https://storage.googleapis.com/golang/$GODIST
    - sudo rm -rf /usr/local/go
    - sudo tar -C /usr/local -xzf download/$GODIST
  post:
    #- docker build --rm=false -t felicianotech/go-sample-webapp:$CIRCLE_SHA1 .
    - docker version
      #- docker run -i -t felicianotech/go-sample-webapp:$CIRCLE_SHA1 /bin/bash
    - docker ps
      #- sudo lxc-attach -n "$(docker inspect --format "{{.Id}}" felicianotech/go-sample-webapp:$CIRCLE_SHA1)" -- bash -c /opt/circleci-testing
  # - sudo rm /etc/apt/sources.list.d/google*
  # - sudo apt-get update
    - go version
test:
  post:
    - ./test.py
deployment:
  production:
    branch: master
    commands:
#      - docker login -e $DOCKER_EMAIL -u $DOCKER_USER -p $DOCKER_PASS
      #- docker push felicianotech/go-sample-webapp:$CIRCLE_SHA1
#      - VARTEST=birthday env | grep VARTEST
      - ls -la
